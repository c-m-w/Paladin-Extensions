<?xml version="1.0" encoding="utf-8"?>
<template_modifications>
  <modification type="public" template="account_details" modification_key="sv_ue_account_details_tags" description="Adds tags to the account details page" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<xf:macro template="custom_fields_macros" name="custom_fields_edit" arg-type="users" arg-group="personal" arg-set="{$xf.visitor.Profile.custom_fields}" />]]></find>
    <replace><![CDATA[$0
<xf:include template="sv_ue_account_details_tags" />]]></replace>
  </modification>
  <modification type="public" template="account_details" modification_key="sv_ue_account_details_username" description="Adds a form row showing a user's user name, alongside a button to edit it" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<xf:formrow rowtype="button".+label="{{ phrase\('email'\) }}"/isU]]></find>
    <replace><![CDATA[<xf:include template="sv_ue_account_details_username" />
$0]]></replace>
  </modification>
  <modification type="public" template="account_details" modification_key="sv_ue_account_details_title" description="Adds an option to revert a username change title to the account details page" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<xf:textboxrow name="user\[custom_title\]" .+ \/>/isU]]></find>
    <replace><![CDATA[$0
<xf:include template="sv_ue_account_details_title" />]]></replace>
  </modification>
  <modification type="public" template="account_upgrades" modification_key="sv_ue_account_upgrades_cost_phrase" description="Removes the cost phrase for user upgrades with customizable costs" execution_order="15" enabled="1" action="str_replace">
    <find><![CDATA[{$upgrade.cost_phrase}]]></find>
    <replace><![CDATA[{{ ($upgrade.cost_amount != '0.00') ? $upgrade.cost_phrase : false }}]]></replace>
  </modification>
  <modification type="public" template="account_upgrades" modification_key="sv_ue_account_upgrades_cost_input" description="Adds a cost input to purchasable user upgrades with customizable costs" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[#hint="{\$upgrade.cost_phrase}".*?<div class="inputGroup">#si]]></find>
    <replace><![CDATA[$0
<xf:include template="sv_ue_account_upgrades_cost_input" />]]></replace>
  </modification>
  <modification type="public" template="account_visitor_menu" modification_key="sv_ue_account_visitor_menu_likes_given" description="Adds a 'Likes given' navigation item to the account visitor menu" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[	<li><a href="{{ link('account/likes') }}" class="menu-linkRow">{{ phrase('likes_received') }}</a></li>]]></find>
    <replace><![CDATA[<xf:include template="sv_ue_account_visitor_menu_likes_given" />
$0]]></replace>
  </modification>
  <modification type="public" template="account_wrapper" modification_key="sv_ue_account_wrapper_watched" description="Adds watched content navigation items to the account wrapper sidebar" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<!--[XF:profile_links:bottom]-->]]></find>
    <replace><![CDATA[<xf:include template="sv_ue_account_wrapper_watched" />
$0]]></replace>
  </modification>
  <modification type="public" template="account_wrapper" modification_key="sv_ue_account_wrapper_conversations" description="Adds conversation navigation items to the account wrapper sidebar" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<h3 class="block-minorHeader">{{ phrase('settings') }}</h3>]]></find>
    <replace><![CDATA[<xf:include template="sv_ue_account_wrapper_conversations" />
$0]]></replace>
  </modification>
  <modification type="public" template="account_wrapper" modification_key="sv_ue_account_wrapper_likes_given" description="Adds a 'Likes given' navigation item to the account wrapper sidebar" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[				<a class="blockLink {{ $pageSelected == 'likes' ? 'is-selected' : '' }}" href="{{ link('account/likes') }}">
					{{ phrase('likes_received') }}
				</a>]]></find>
    <replace><![CDATA[<xf:include template="sv_ue_account_wrapper_likes_given" />
$0]]></replace>
  </modification>
  <modification type="public" template="approval_item_user" modification_key="approval_item_user_last_activity" description="Add user activity to user approval form" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<xf:set var="$fromRegFields">]]></find>
    <replace><![CDATA[<xf:formrow label="{{ phrase('last_activity') }}">
	<xf:date time="{$content.last_activity}" />
</xf:formrow>
$0]]></replace>
  </modification>
  <modification type="public" template="conversation_add" modification_key="sv_ue_conversation_add_wrap" description="Adds the account wrapper to the add conversation page" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/^/isU]]></find>
    <replace><![CDATA[<xf:if is="$xf.options.useress_conversationWrapper">
	<xf:wrap template="account_wrapper">
		<xf:set var="$pageSelected" value="conversations_add" />
	</xf:wrap>
</xf:if>
$0]]></replace>
  </modification>
  <modification type="public" template="conversation_list" modification_key="sv_ue_conversation_list_wrap" description="Adds the account wrapper to the conversation list" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/^/isU]]></find>
    <replace><![CDATA[<xf:if is="$xf.options.useress_conversationWrapper">
	<xf:wrap template="account_wrapper">
		<xf:set var="$pageSelected" value="conversations_view" />
	</xf:wrap>
</xf:if>
$0]]></replace>
  </modification>
  <modification type="public" template="conversation_view" modification_key="sv_ue_conversation_view_wrap" description="Adds the account wrapper to conversations" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/^/isU]]></find>
    <replace><![CDATA[<xf:if is="$xf.options.useress_conversationWrapper">
	<xf:wrap template="account_wrapper">
		<xf:set var="$pageSelected" value="conversations_view" />
	</xf:wrap>
</xf:if>
$0]]></replace>
  </modification>
  <modification type="public" template="helper_account" modification_key="sv_ue_account_privacy_visibility" description="Wraps user visibility preferences in a permission check" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/(<xf:macro name="activity_privacy_row">)(.+)(<\/xf:macro>)/isU]]></find>
    <replace><![CDATA[$1
	<xf:if is="$xf.visitor.canGoInvisible()">
		$2
	</xf:if>
$3]]></replace>
  </modification>
  <modification type="public" template="helper_thread_options" modification_key="sv_ue_helper_thread_options_permissions" description="Includes thread permission options in thread status macro" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/(<xf:macro name="thread_status".+)(<\/xf:macro>)/isU]]></find>
    <replace><![CDATA[$1
<xf:include template="sv_ue_helper_thread_options_permissions" />
$2]]></replace>
  </modification>
  <modification type="public" template="member_view" modification_key="sv_ue_member_view_tab_pane_previous_names" description="Adds a 'Previous names' tab pane to member profiles" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<!--[XF:tab_panes:end]-->]]></find>
    <replace><![CDATA[<xf:include template="sv_ue_member_view_tab_pane_previous_names" />
$0]]></replace>
  </modification>
  <modification type="public" template="member_view" modification_key="sv_ue_member_view_tab_previous_names" description="Adds a 'Previous names' tab to member profiles" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<!--[XF:tabs:end]-->]]></find>
    <replace><![CDATA[<xf:include template="sv_ue_member_view_tab_previous_names" />
$0]]></replace>
  </modification>
  <modification type="public" template="member_view" modification_key="sv_ue_member_view_tags" description="Adds tags to the member profile page" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[						<xf:if contentcheck="true">
							<dl class="pairs pairs--inline memberHeader-blurb">
								<dt>{{ phrase('last_seen') }}</dt>
								<dd dir="auto">
									<xf:contentcheck><xf:useractivity user="$user" class="pairs--plainLabel" /></xf:contentcheck>
								</dd>
							</dl>
						</xf:if>]]></find>
    <replace><![CDATA[$0
<xf:include template="sv_ue_member_view_tags" />]]></replace>
  </modification>
  <modification type="public" template="post_edit" modification_key="sv_ue_post_edit_thread_title" description="Applies permission check to thread title editing" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/(<xf:if is=".*)\$thread.canEdit\(\)(.*">.+<xf:prefixinputrow)/isU]]></find>
    <replace><![CDATA[$1$thread.canEditTitle()$2]]></replace>
  </modification>
  <modification type="public" template="post_macros" modification_key="sv_ue_post_macros_last_edit_align" description="Aligns the last edit" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/(<div class="message-lastEdit)(">.+<\/div>)/isU]]></find>
    <replace><![CDATA[<xf:if is="$xf.options.useressLastEditedByPosition == 'left'">
	<xf:css src="sv_ue.less" />
</xf:if>
$1 {{ ($xf.options.useressLastEditedByPosition == 'left') ? 'message-lastEdit--align-left' : '' }} $2]]></replace>
  </modification>
  <modification type="public" template="register_macros" modification_key="sv_ue_register_macros_username_explain" description="Alters the username field explain phrase" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[this_is_name_that_will_be_shown_with_your_messages]]></find>
    <replace><![CDATA[sv_ue_this_is_name_that_will_be_shown_with_your_messages]]></replace>
  </modification>
  <modification type="public" template="thread_edit" modification_key="sv_ue_thread_edit_title" description="Applies permission check to title editing" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<xf:prefixinputrow.+\/>/isU]]></find>
    <replace><![CDATA[<xf:if is="$thread.canEditTitle()">
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="admin" template="tools_rebuild" modification_key="sv_ue_tools_rebuild" description="Adds user essentials rebuild tools to the cache rebuild tools" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<!--[XF:rebuild_bottom]-->]]></find>
    <replace><![CDATA[<xf:include template="sv_ue_tools_rebuild" />
$0]]></replace>
  </modification>
  <modification type="admin" template="user_edit" modification_key="sv_ue_user_edit_username" description="Adds a list of previous username and some options to the user edit form" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<xf:textboxrow name="user[email]"]]></find>
    <replace><![CDATA[<xf:include template="sv_ue_user_edit_username" />
$0]]></replace>
  </modification>
  <modification type="admin" template="user_edit" modification_key="sv_ue_user_edit_login_attempts_tab" description="Adds a login attempts tab to the user edit page" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<a class="tabs-tab" role="tab" tabindex="0" aria-controls="user-ips">{{ phrase('ip_addresses') }}</a>]]></find>
    <replace><![CDATA[$0
<xf:include template="sv_ue_user_edit_login_attempts_tab" />]]></replace>
  </modification>
  <modification type="admin" template="user_edit" modification_key="sv_ue_user_edit_login_attempts_pane" description="Adds a login attempts pane to the user edit page" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<xf:if.+>.+id="user-ips".+<\/xf:if>/isU]]></find>
    <replace><![CDATA[$0
<xf:include template="sv_ue_user_edit_login_attempts_pane" />
]]></replace>
  </modification>
  <modification type="admin" template="user_edit" modification_key="user_edit_readonly_primarygroup" description="Prevent administrators changing the primary group" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[name="user[user_group_id]"]]></find>
    <replace><![CDATA[$0 readonly="{{ $xf.options.useressPreventPrimaryGroupChange ? '1' : '' }}"]]></replace>
  </modification>
  <modification type="admin" template="user_edit" modification_key="sv_ue_user_edit_title" description="Adds an option to revert a username change title to the user edit form" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<xf:textboxrow name="user\[custom_title\]" .+ \/>/isU]]></find>
    <replace><![CDATA[$0
<xf:include template="sv_ue_user_edit_title" />]]></replace>
  </modification>
  <modification type="admin" template="user_upgrade_edit" modification_key="sv_ue_user_upgrade_edit_quantity" description="Adds a quantity input to the user upgrade form" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<xf:macro template="display_order_macros".+\/>/isU]]></find>
    <replace><![CDATA[$0
<xf:include template="sv_ue_user_upgrade_edit_quantity" />]]></replace>
  </modification>
  <modification type="public" template="watched_forums_list" modification_key="sv_ue_watched_forums_list_wrap" description="Adds the account wrapper to the watched forums list" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/^/isU]]></find>
    <replace><![CDATA[<xf:if is="$xf.options.useress_watchedWrapper">
	<xf:wrap template="account_wrapper">
		<xf:set var="$pageSelected" value="watched_forums" />
	</xf:wrap>
</xf:if>
$0]]></replace>
  </modification>
  <modification type="public" template="watched_threads_list" modification_key="sv_ue_watched_threads_list_wrap" description="Adds the account wrapper to the watched threads list" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/^/isU]]></find>
    <replace><![CDATA[<xf:if is="$xf.options.useress_watchedWrapper">
	<xf:wrap template="account_wrapper">
		<xf:set var="$pageSelected" value="watched_threads" />
	</xf:wrap>
</xf:if>
$0]]></replace>
  </modification>
</template_modifications>
