<?xml version="1.0" encoding="utf-8"?>
<template_modifications>
  <modification type="public" template="core.less" modification_key="xr_product_manager_less" description="XR Product Manager Style" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[{{ include('core_button.less') }}]]></find>
    <replace><![CDATA[$0
<xf:if is="property('xm_xrProductManagerOn') == '1'">
{{ include('xrProductsLayout.less') }}
{{ include('xrProductsHoverEffect.less') }}	
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="xr_pm_category_view" modification_key="xm_category_view_gridSectionClassAdd" description="Category ViewGrid Section Class Add" execution_order="60" enabled="1" action="str_replace">
    <find><![CDATA[<div class="structItemContainer">]]></find>
    <replace><![CDATA[<xf:if is="property('xm_xrProductManagerOn') == '1'">
	<div class="structItemContainer gridSection gridGroup">
		<xf:else />
	<div class="structItemContainer">	
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="xr_pm_overview" modification_key="xm_gridSectionClassAdd" description="Grid Section Class Add" execution_order="20" enabled="1" action="str_replace">
    <find><![CDATA[<div class="structItemContainer">]]></find>
    <replace><![CDATA[<xf:if is="property('xm_xrProductManagerOn') == '1'">
	<div class="structItemContainer gridSection gridGroup">
		<xf:else />
	<div class="structItemContainer">	
</xf:if>	]]></replace>
  </modification>
  <modification type="public" template="xr_pm_product_list_macros" modification_key="xm_gridCol_gridSpan" description="GridCol GridSpan Class Add" execution_order="30" enabled="1" action="str_replace">
    <find><![CDATA[<div class="structItem structItem--product js-productListItem-{$product.product_id}" data-author="{{ $product.User.username ?: $product.username }}">]]></find>
    <replace><![CDATA[<xf:if is="property('xm_xrProductManagerOn') == '1'">
	<div class="structItem structItem--product js-productListItem-{$product.product_id} gridCol gridSpan" data-author="{{ $product.User.username ?: $product.username }}">
	<xf:else />
	<div class="structItem structItem--product js-productListItem-{$product.product_id}" data-author="{{ $product.User.username ?: $product.username }}">	
</xf:if>	]]></replace>
  </modification>
  <modification type="public" template="xr_pm_product_list_macros" modification_key="xm_product_price_ribbon" description="Product Price Ribbon" execution_order="40" enabled="1" action="str_replace">
    <find><![CDATA[<div class="structItem-iconContainer">]]></find>
    <replace><![CDATA[$0
				<xf:if is="property('xm_xrProductManagerOn') == '1'">
				<xf:if is="property('xm_productRibbonPrice') == '1'">
				<div class="price">{$product.price|xr_pm_currency($product.currency)}</div>
				</xf:if>
				</xf:if>]]></replace>
  </modification>
  <modification type="public" template="xr_pm_product_list_macros" modification_key="xm_product_imageHover" description="XR Product Manager Image Hover Effect" execution_order="50" enabled="1" action="str_replace">
    <find><![CDATA[{{ xr_pm_thumbnail($product, link('products', $product)) }}]]></find>
    <replace><![CDATA[<xf:if is="property('xm_xrProductManagerOn') == '1'">
		<div class="{{ property('xm_xrImageHoverEffect') }}">
			<div class="img-box">
				{{ xr_pm_thumbnail($product, link('products', $product)) }}
			</div>
			<div class="info-box">
				<div class="info-content">
					<h3><a href="{{ link('products', $product) }}" data-tp-primary="on">{$product.product_title}</a> <span class="u-muted">{$product.Version.version_string}</span></h3>
					<span class="separator"></span>
					<p>{$product.product_tag_line}</p>
					<span class="separator"></span>
					<div class="smallest-content">
					<xf:if is="property('xm_productCustomFieldsButtons') == '1'">
						<xf:foreach loop="$xf.app.getCustomFields('xr_pm_products', 'tab_link')" key="$fieldId" value="$fieldDefinition">
							<xf:if is="$fieldDefinition.hasValue({$product.custom_fields.{$fieldDefinition.field_id}})">
								<xf:button icon="preview" class="button--product Tooltip" target="{{ property('xm_xrCustomFieldsButtonsOpen') }}" href="{$product.custom_fields.{$fieldDefinition.field_id}}"
									data-xf-init="tooltip" title="{{$fieldDefinition.title}}" rel="nofollow"><span class="linkText">{$fieldDefinition.title}</span>
								</xf:button>	
							</xf:if>
						</xf:foreach>
					</xf:if>
					<xf:if is="$product.canPurchase()">
						<xf:button icon="purchase" class="button--product button--cta Tooltip" href="{{ link('products/buy', $product) }}" data-xf-click="overlay"
								data-xf-init="tooltip" title="{{ phrase('xr_pm_buy_now')|for_attr }}" rel="nofollow">
							<xf:if is="$product.price">
								<span class="linkText">{{ phrase('xr_pm_buy_now') }}</span>
							<xf:else />
								<span class="linkText">{{ phrase('xr_pm_get_free_now') }}</span>
							</xf:if>
						</xf:button>
					</xf:if>					
					</div>
				</div>
			</div>
		</div>
	<xf:else />
		{{ xr_pm_thumbnail($product, link('products', $product)) }}		
</xf:if>]]></replace>
  </modification>
</template_modifications>
