<?xml version="1.0" encoding="utf-8"?>
<template_modifications>
  <modification type="public" template="account_visitor_menu" modification_key="th_account_visitor_menu_reactions" description="Adds reactions count to visitor menu" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<dt>{{ phrase\('likes'\) }}<\/dt>(.*?)<\/dd>/s]]></find>
    <replace><![CDATA[<xf:macro template="th_display_reactions" name="react_total_text" arg-reacts="{$xf.visitor.react_count}" arg-reactsCount="{$xf.visitor.getReactTotalCount()}" />]]></replace>
  </modification>
  <modification type="public" template="conversation_list_macros" modification_key="th_conversation_list_macros_reactions" description="Adds the first post reactions to the conversation list item" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/(<ul class="structItem-statuses">.*<\/ul>.*<\/xf:if>)/Us]]></find>
    <replace><![CDATA[$0
<xf:macro template="th_display_reactions" name="reactions_bit_list" arg-type="conversation_message" arg-id="first_message_id" arg-content="{$userConv.Master}" arg-reactUsers="{$userConv.Master.getReactUsers()}" />]]></replace>
  </modification>
  <modification type="public" template="conversation_message_macros" modification_key="th_conversation_message_macros_likeBar_reactions" description="Removes the default like bar from conversation messages" execution_order="500" enabled="1" action="preg_replace">
    <find><![CDATA[/<div class="likesBar.*?<\/div>/s]]></find>
    <replace><![CDATA[<xf:if is="!{{ react_handler_status('conversation_message') }}">
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="conversation_message_macros" modification_key="th_conversation_message_macros_button_reactions" description="Removes the default like/unlike button from conversation messages" execution_order="500" enabled="1" action="preg_replace">
    <find><![CDATA[/(<xf:if is="\$message.canLike\(\)">.*<a.*<\/a>.*<\/xf:if>)/Us]]></find>
    <replace><![CDATA[<xf:if is="!{{ react_handler_status('conversation_message') }}">
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="conversation_message_macros" modification_key="th_conversation_message_macros_bar_reactions" description="Adds the reactions bar to conversation messages" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<footer class="message-footer">]]></find>
    <replace><![CDATA[<xf:macro template="th_display_reactions" name="reactions_bar" arg-type="conversation_message" arg-id="message_id" arg-content="{$message}" />

$0]]></replace>
  </modification>
  <modification type="public" template="message_macros" modification_key="th_message_macros_reactions" description="Puts the user's given react count into the postbit." execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/(<div class="message-userExtras">.*<xf:contentcheck>)(.*?)(<\/xf:contentcheck>.*<\/div>)/Us]]></find>
    <replace><![CDATA[$1
<xf:if is="{{ property('th_showReactionsPostbit_reactions') }} && {{ property('th_showReactionsPostbit_location_reactions') }} == 'top'">
	<xf:macro template="th_display_reactions" name="react_postbit" arg-reacts="{$user.react_count}" arg-reactsCount="{$user.getReactTotalCount()}" arg-displayType="{{ property('th_showReactionsPostbit_displayType_reactions') }}" arg-displayLocation="top" />
</xf:if>
$2
<xf:if is="{{ property('th_showReactionsPostbit_reactions') }} && {{ property('th_showReactionsPostbit_location_reactions') }} == 'bottom'">
	<xf:macro template="th_display_reactions" name="react_postbit" arg-reacts="{$user.react_count}" arg-reactsCount="{$user.getReactTotalCount()}" arg-displayType="{{ property('th_showReactionsPostbit_displayType_reactions') }}" arg-displayLocation="bottom" />
</xf:if>
$3]]></replace>
  </modification>
  <modification type="public" template="post_macros" modification_key="th_post_macros_bar_abovesig_reactions" description="Adds the reactions bar to posts (above signature)" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<xf:macro template="message_macros" name="signature" arg-user="{$post.User}" />]]></find>
    <replace><![CDATA[<xf:if is="reaction_bar_position('post') == 'abovesig'">
	<xf:macro template="th_display_reactions" name="reactions_bar" arg-type="post" arg-id="post_id" arg-content="{$post}" />
</xf:if>

$0]]></replace>
  </modification>
  <modification type="public" template="post_macros" modification_key="th_post_macros_bar_reactions" description="Adds the reactions bar to posts" execution_order="10" enabled="0" action="str_replace">
    <find><![CDATA[<footer class="message-footer">]]></find>
    <replace><![CDATA[<xf:macro template="th_display_reactions" name="reactions_bar" arg-type="post" arg-id="post_id" arg-content="{$post}" />

$0]]></replace>
  </modification>
  <modification type="public" template="post_macros" modification_key="th_post_macros_likeBar_reactions" description="Removes the default like bar from posts" execution_order="500" enabled="1" action="preg_replace">
    <find><![CDATA[/<div class="likesBar.*?<\/div>/s]]></find>
    <replace><![CDATA[<xf:if is="!{{ react_handler_status('post') }}">
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="post_macros" modification_key="th_post_macros_button_reactions" description="Removes the default like/unlike button from posts" execution_order="500" enabled="1" action="preg_replace">
    <find><![CDATA[/(<xf:if is="\$post.canLike\(\)">.*<a.*<\/a>.*<\/xf:if>)/Us]]></find>
    <replace><![CDATA[<xf:if is="!{{ react_handler_status('post') }}">
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="post_macros" modification_key="th_post_macros_bar_belowsig_reactions" description="Adds the reactions bar to posts (below signature)" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<footer class="message-footer">]]></find>
    <replace><![CDATA[<xf:if is="reaction_bar_position('post') == 'belowsig'">
	<xf:macro template="th_display_reactions" name="reactions_bar" arg-type="post" arg-id="post_id" arg-content="{$post}" />
</xf:if>

$0]]></replace>
  </modification>
  <modification type="public" template="profile_post_macros" modification_key="th_profile_post_macros_comment_likeBar_reactions" description="Removes the default like bar from profile post comments" execution_order="500" enabled="1" action="preg_replace">
    <find><![CDATA[/<div class="comment-likes.*?<\/div>/s]]></find>
    <replace><![CDATA[<xf:if is="!{{ react_handler_status('profile_post_comment') }}">
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="profile_post_macros" modification_key="th_profile_post_macros_likeBar_reactions" description="Removes the default like bar from profile posts" execution_order="500" enabled="1" action="preg_replace">
    <find><![CDATA[/<div class="message-responseRow message-responseRow--likes.*?<\/div>/s]]></find>
    <replace><![CDATA[<xf:if is="!{{ react_handler_status('profile_post') }}">
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="profile_post_macros" modification_key="th_profile_post_macros_button_reactions" description="Removes the default like/unlike button from profile posts" execution_order="500" enabled="1" action="preg_replace">
    <find><![CDATA[/(<xf:if is="\$profilePost.canLike\(\)">.*<a.*<\/a>.*<\/xf:if>)/Us]]></find>
    <replace><![CDATA[<xf:if is="!{{ react_handler_status('profile_post') }}">
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="profile_post_macros" modification_key="th_profile_post_comments_macros_bar_reactions" description="Adds the reactions bar to profile post comments" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<footer class="comment-footer">]]></find>
    <replace><![CDATA[<xf:macro template="th_display_reactions" name="reactions_bar" arg-type="profile_post_comment" arg-id="profile_post_comment_id" arg-content="{$comment}" />

$0]]></replace>
  </modification>
  <modification type="public" template="profile_post_macros" modification_key="th_profile_post_comments_macros_button_reactions" description="Removes the default like/unlike button from profile post comments" execution_order="500" enabled="1" action="preg_replace">
    <find><![CDATA[/(<xf:if is="\$comment.canLike\(\)">.*<a.*<\/a>.*<\/xf:if>)/Us]]></find>
    <replace><![CDATA[<xf:if is="!{{ react_handler_status('profile_post_comment') }}">
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="profile_post_macros" modification_key="th_profile_post_macros_bar_reactions" description="Adds the reactions bar to profile posts" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<footer class="message-footer">]]></find>
    <replace><![CDATA[<xf:macro template="th_display_reactions" name="reactions_bar" arg-type="profile_post" arg-id="profile_post_id" arg-content="{$profilePost}" />

$0]]></replace>
  </modification>
  <modification type="public" template="thread_list_macros" modification_key="th_thread_list_macros_reactions" description="Adds the first post reactions to the thread list item" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/(<ul class="structItem-statuses">.*<\/ul>.*<\/xf:if>)/Us]]></find>
    <replace><![CDATA[$0

<xf:if is="{{ react_handler_status('post') }}">
		<xf:macro template="th_display_reactions" name="reactions_bit_list" arg-type="post" arg-id="first_post_id" arg-content="{$thread}" arg-reactUsers="{$thread.getReactUsers()}" />
</xf:if>
]]></replace>
  </modification>
  <modification type="public" template="xfmg_media_view" modification_key="th_xfmg_media_view_likeBar_reactions" description="Removes the default like bar from media" execution_order="500" enabled="1" action="preg_replace">
    <find><![CDATA[/<div class="likesBar.*?<\/div>/s]]></find>
    <replace><![CDATA[<xf:if is="!{{ react_handler_status('xfmg_media') }}">
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="xfmg_media_view" modification_key="th_xfmg_media_view_bar_reactions" description="Adds the reactions bar to media items" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<xf:if contentcheck="true">\n[ \t]+<div class="actionBar">/]]></find>
    <replace><![CDATA[<xf:macro template="th_display_reactions" name="reactions_bar" arg-type="xfmg_media" arg-id="media_id" arg-content="{$mediaItem}" />

$0]]></replace>
  </modification>
  <modification type="public" template="xfmg_media_view" modification_key="th_xfmg_media_view_button_reactions" description="Removes the default like/unlike button from media" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/(<xf:if is="\$mediaItem.canLike\(\)">.*<a.*<\/a>.*<\/xf:if>)/Us]]></find>
    <replace><![CDATA[<xf:if is="!{{ react_handler_status('xfmg_media') }}">
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="xfrm_resource_view" modification_key="th_xfrm_resource_view_button_reactions" description="Removes the default like/unlike button from resources" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/(<xf:if is="\$description.canLike\(\)">.*<a.*<\/a>.*<\/xf:if>)/Us]]></find>
    <replace><![CDATA[<xf:if is="!{{ react_handler_status('resource_update') }}">
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="xfrm_resource_view" modification_key="th_xfrm_resource_view_bar_reactions" description="Adds the reactions bar to resources" execution_order="10" enabled="1" action="preg_replace">
    <find><![CDATA[/<xf:if contentcheck="true">\n[ \t]+<div class="actionBar">/]]></find>
    <replace><![CDATA[<xf:macro template="th_display_reactions" name="reactions_bar" arg-type="resource_update" arg-id="resource_update_id" arg-content="{$description}" />

$0]]></replace>
  </modification>
  <modification type="public" template="xfrm_resource_view" modification_key="th_xfrm_resource_view_likeBar_reactions" description="Removes the default like bar from resources" execution_order="500" enabled="1" action="preg_replace">
    <find><![CDATA[/<div class="likesBar.*?<\/div>/s]]></find>
    <replace><![CDATA[<xf:if is="!{{ react_handler_status('resource_update') }}">
	$0
</xf:if>]]></replace>
  </modification>
</template_modifications>
