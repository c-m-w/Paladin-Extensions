/*
 kl/editor-manager/plugins/inlineSpoiler.plugin.js
 License https://creativecommons.org/licenses/by-nc-nd/4.0/legalcode
 Copyright 2017 Lukas Wieditz
*/
(function(b){b.FE.DefineIcon("xfKLEMiSpoiler",{NAME:"eye-slash"});b.FE.RegisterCommand("xfKLEMiSpoiler",{title:"Inline Spoiler",icon:"xfKLEMiSpoiler",undo:!0,focus:!0,callback:function(){var c=this;XF.EditorHelpers.loadDialog(c,"ispoiler",function(a){b("#editor_kl_em_ispoiler_submit").click(function(d){d.preventDefault();c.selection.restore();XF.EditorHelpers.insertKLEMiSpoiler(c,b("#editor_kl_em_ispoiler_title").val());a.hide()})},function(c){var a=b("#editor_kl_em_ispoiler_title").val("");setTimeout(function(){a.autofocus()},
0)},!0)}});XF.EditorHelpers.insertKLEMiSpoiler=function(b,a){XF.EditorHelpers.wrapSelectionText(b,a?'[ISPOILER="'+a+'"]':"[ISPOILER]","[/ISPOILER]",!0)};b(document).on("editor:config",function(c,a,d){XF.EditorDialogiSpoiler=XF.extend(XF.EditorDialog,{_beforeShow:function(a){b("#editor_kl_em_ispoiler_title").val("")},_init:function(a){b("#editor_kl_em_ispoiler_form").submit(b.proxy(this,"submit"))},submit:function(a){a.preventDefault();a=this.ed;var c=this.overlay;a.selection.restore();XF.EditorHelpers.insertKLEMiSpoiler(a,
b("#editor_kl_em_ispoiler_title").val());c.hide()}});XF.EditorHelpers.dialogs.ispoiler=new XF.EditorDialogiSpoiler("ispoiler")})})(jQuery);